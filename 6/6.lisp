(ql:quickload :cl-base64)
(ql:quickload :cl-ppcre)

(defun score (str)
  (length
    (cl-ppcre:all-matches-as-strings "(?i)[etaoin shrldu]" str)))

(defun decrypt (bytes key)
  (format nil "窿磲疸狎＇灬礅溽ㄨㄣ镤瀛汨狎祜瑛矧脲┅怡翦螬┅ㄤ彐躅麸怡翦篝颟磲ъ轶＇汨狎泔溴篝颟ㄤ彐泔铙翎铘轭瘐舡怡翦鏖翳镳孱骈戾ㄩ铙趄遽⒍豇簪麸怡翦ㄣ飙忉箦洞衡狍宥喘篝蝈犴麸篝蜷铉轭篝蝈犴┅┅ㄤ彐躅怡翦溟篝犷沐ㄢ翦怡翦博灬忮祗è矧蝈篚祠殇铛憝溟骀忾趔ㄩ弪镳殇铛憝溟骀忾趔ㄈㄡ箬矧蝈篚祠暴ū殇ǐ铛憝溟骀忾趔祜玑钿矧蝈篚祠暴┅┅ㄈ祜瑛矧怡翦怡翦博癌┅ㄤ彐躅栳眄轭绛溟篝犷沐ㄢ翦蟊怡翦蟛灬忮祗èㄢ翦蟊怡翦蟛泔躅舂ㄩ铛祆怡翦蟊泔躅ㄈㄣ潋怡翦蟊ㄣ潋怡翦蟛ǐ泔躅ㄢ翦溟篝犷沐ㄣ狎怡翦蟊ㄣ狎怡翦蟛┅┅┅ㄈ怡翦蟊怡翦蟛癌┅ㄤ彐躅铒蝽犰辁邃栳眄轭绛溟篝犷沐ㄢ翦蟊怡翦蟛ǒㄨ犴黹铉溟篝犷沐怡翦蟊怡翦蟛戾铉翳怡翦蟊┅ㄤ彐躅轭箪殂弩祗舡祗氅灬忮祗èé脲祗殇箪殂瀛箪殂瀛徙悌ㄣ镱è铛祆祗舂蝈鲥蝮ㄩ戾铉翳箪殂瀛博氅ㄦ躅汜祆祗舡箪殂瀛蝈鲥蝮箪殂瀛博徙悌徙悌┅è殇氅戾è沲蝈鲥蝮箪殂瀛博┅ㄟ红篝祗洪澍后扉沐沲后扉沐Ж横沣ㄦ躅汜祆祗舡箪殂瀛沲徙悌┅ㄟ红篝ㄣ潋祗舂洪澍ū殇后扉沐箪殂瀛后扉沐ㄣ镱ㄣ狎祗舂箪殂瀛博横沣徙悌┅┅ㄟ红篝祗洪澍后扉沐Ж后扉沐Ж洪澍Ж┅┅ㄤ彐躅徙沲眭灬翦栳眄轭绛溟篝犷沐ㄢ翦蟊怡翦蟛徙悌ㄩㄡ钿怡翦蟊怡翦蟛戾è蝈铒蝽犰辁邃栳眄轭绛溟篝犷沐怡翦蟊怡翦蟛┅ㄣ镱蝈徙悌徙悌换蝈趱蝾轭徙躅汨犷珏轭翳轶汜箦忮汜躞轭箪殂弩躞弩翳徙沲眭灬麸疳趑弪ㄤ彐躅狯弪徵瀛栳眄轭绛溟篝犷沐ㄩ铕豸脲箝濠戾è栳眄轭绛溟篝犷沐ㄩ瞽箪殂弩＇徙沲眭灬翦栳眄轭绛溟篝犷沐轭瘐脲箝濠┅ǒ蝈漉沐＇栳眄轭绛溟篝犷沐螬戾铉翳栳眄轭绛溟篝犷沐螬┅ㄤ彐躅盹篝扉脲禊脲箝ㄩ铕豸脲骝镯脲箝麸脲箝濠灬忮祗èㄦ蝻憝脲箝徙悌ㄩ骝镯脲箝麸脲箝濠徙戾è徼ㄡ鲥蜥珏栳眄轭绛溟篝犷沐轭瘐骝镯脲箝濠┅ㄟū骝镯脲箝濠ㄣ镱ㄣ镱骝镯脲箝徼洎徙悌┅┅ㄣ後箫螋ㄟ骝镯脲箝Ж┅＇弘妁＇沅颟┅ㄤ彐躅徙沲眭灬翦忪镢塍ㄢ翦蟊怡翦蟛徙悌ㄣ镱怡翦蟛徙悌ㄤ彐躅轭忪镢塍ㄩ铕豸氅ㄩ瞽箪殂弩＇徙沲眭灬翦忪镢塍轭瘐氅ㄤ彐躅趄犷箴矬邃忪镢塍ㄩ铕豸氅ㄡ痧禊＇磲疸狎＇扉篝ㄩ瞽忪镢塍轭瘐氅┅ㄤ彐躅溴泸痿骈邃脲箫礤忪镢氅戾è磲癌脲汨狎┅ㄤè脲ū脲┅è脲辈珐脲汨狎戾舄è蝈ㄤ邈蝙痿箫礤忪镢脲┅筱矧筱矧蝈螬┅麒孱筱矧磲箦翩磲筱矧脲汨狎脲┅┅┅戾舄è脲箝盹篝扉脲禊脲箝轭瘐舡怡翦烘蝻憝脲箝呼锃脲箝窗┅ㄢ祜汶趄犷箴矬邃忪镢塍轭瘐舡怡翦脲箝濠┅磲篝蜷铉＇泔溴汨狎磲疸狎＇溴泸痿骈邃脲忪镢塍┅换藻蝽轭狒矧睾买轭翳铒轶澧